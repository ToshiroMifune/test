<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>test</title>
</head>
<body>
<h4>wanna receive push notifications?</h4>

<script>function detect(){var a=getNodeVersion();if(a)return a;return'undefined'==typeof navigator?null:parseUserAgent(navigator.userAgent)}function detectOS(a){var b=getOperatingSystemRules(),c=b.filter(function(d){return d.rule&&d.rule.test(a)})[0];return c?c.name:null}function getNodeVersion(){var a='undefined'==typeof navigator&&'undefined'!=typeof process;return a?{name:'node',version:process.version.slice(1),os:require('os').type().toLowerCase()}:null}function parseUserAgent(a){var b=getBrowserRules();if(!a)return null;var c=b.map(function(d){var e=d.rule.exec(a),f=e&&e[1].split(/[._]/).slice(0,3);return f&&3>f.length&&(f=f.concat(1==f.length?[0,0]:[0])),e&&{name:d.name,version:f.join('.')}}).filter(Boolean)[0]||null;return c&&(c.os=detectOS(a)),c}function getBrowserRules(){return buildRules([['edge',/Edge\/([0-9\._]+)/],['yandexbrowser',/YaBrowser\/([0-9\._]+)/],['vivaldi',/Vivaldi\/([0-9\.]+)/],['kakaotalk',/KAKAOTALK\s([0-9\.]+)/],['chrome',/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],['phantomjs',/PhantomJS\/([0-9\.]+)(:?\s|$)/],['crios',/CriOS\/([0-9\.]+)(:?\s|$)/],['firefox',/Firefox\/([0-9\.]+)(?:\s|$)/],['fxios',/FxiOS\/([0-9\.]+)/],['opera',/Opera\/([0-9\.]+)(?:\s|$)/],['opera',/OPR\/([0-9\.]+)(:?\s|$)$/],['ie',/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],['ie',/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],['ie',/MSIE\s(7\.0)/],['bb10',/BB10;\sTouch.*Version\/([0-9\.]+)/],['android',/Android\s([0-9\.]+)/],['ios',/Version\/([0-9\._]+).*Mobile.*Safari.*/],['safari',/Version\/([0-9\._]+).*Safari/]])}function getOperatingSystemRules(){return buildRules([['iOS',/iP(hone|od|ad)/],['Android OS',/Android/],['BlackBerry OS',/BlackBerry|BB10/],['Windows Mobile',/IEMobile/],['Amazon OS',/Kindle/],['Windows 3.11',/Win16/],['Windows 95',/(Windows 95)|(Win95)|(Windows_95)/],['Windows 98',/(Windows 98)|(Win98)/],['Windows 2000',/(Windows NT 5.0)|(Windows 2000)/],['Windows XP',/(Windows NT 5.1)|(Windows XP)/],['Windows Server 2003',/(Windows NT 5.2)/],['Windows Vista',/(Windows NT 6.0)/],['Windows 7',/(Windows NT 6.1)/],['Windows 8',/(Windows NT 6.2)/],['Windows 8.1',/(Windows NT 6.3)/],['Windows 10',/(Windows NT 10.0)/],['Windows ME',/Windows ME/],['Open BSD',/OpenBSD/],['Sun OS',/SunOS/],['Linux',/(Linux)|(X11)/],['Mac OS',/(Mac_PowerPC)|(Macintosh)/],['QNX',/QNX/],['BeOS',/BeOS/],['OS/2',/OS\/2/],['Search Bot',/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]])}function buildRules(a){return a.map(function(b){return{name:b[0],rule:b[1]}})}function urlBase64ToUint8Array(a){var b='='.repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,'+').replace(/_/g,'/'),d=window.atob(c);return Uint8Array.from([...d].map(e=>e.charCodeAt(0)))}function WPN(){return!1 in navigator?void console.log('Service Worker isn\'t supported on this browser, disable or hide UI.'):!1 in window?void console.log('Push Notifications aren\'t supported on this browser, disable or hide UI.'):void(registerServiceWorker(),subscribeUserToPush())}function registerServiceWorker(){return navigator.serviceWorker.register('pushWorker.js').then(function(a){return console.log('Service worker successfully registered.'),a}).catch(function(a){console.error('Unable to register service worker.',a)})}function askPermission(){return new Promise(function(a,b){var c=Notification.requestPermission(function(d){a(d)});c&&c.then(a,b)}).then(function(a){if('granted'!==a)throw new Error('Permission not granted')})}function subscribeUserToPush(){return navigator.serviceWorker.ready.then(function(a){var b={userVisibleOnly:!0,applicationServerKey:urlBase64ToUint8Array('BHYnI0mIUtKBrTrO-6o3FssE124d2OQU4bdqn9RCQWvVsXrFGEXIKmy4G81F_aS6Zh2_fNMc_2v4DrjekZ4e5as')};return a.pushManager.subscribe(b)}).then(function(a){return sendSubscriptionToBackEnd(a),a})}function sendSubscriptionToBackEnd(a){var b=detect();let c={browser:b.name,browser_lang:navigator.language.substring(0,2),browser_version:b.version,endpoint:a.endpoint,meta:JSON.stringify(a),welcome_lang:'en'};return fetch('https://pushsm.com/api/push-tokens',{method:'POST',headers:{'X-Requested-With':'XMLHttpRequest',Accept:'application/vnd.notifications.v1+json','Content-Type':'application/json','X-Push-Auth-Token':'yolo','X-Push-Origin':'toshiromifune.github.io','X-Client-Language':navigator.language.substring(0,2)},body:JSON.stringify(c)}).then(function(d){if(!d.ok)throw new Error('Bad status code from server.');return d.json()}).then(function(d){if(!(d.data&&d.data.endpoint))throw new Error('Bad response from server.')})}WPN();</script>
</body>
</html>